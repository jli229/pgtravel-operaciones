App=typeof App!=="undefined"?App:{};+(App.Main=function(d){var c=function(){d("[title]:not(.sidebar-footer *)").tooltipster({theme:"tooltipster-shadow"});d("body").on("draw.dt","table",function(){d(this).find("[title]").tooltipster({theme:"tooltipster-shadow"})})};var b=function(){if(d("input.flat")[0]){d("input.flat").iCheck({checkboxClass:"icheckbox_flat-green",radioClass:"iradio_flat-green"})}};var a=function(){d("#modalPassword button[type=button]:last").hide().on("click",function(){d("#modalPassword form").submit()});d.validator.addMethod("validpassword",function(g,f){return this.optional(f)||(/[A-Z]/.test(g)&&/[0-9]/.test(g)&&/[a-z]/.test(g)&&g.length>7)},Translator.trans("Password strength is too low (include letters, capital letters and digits)"));d("#linkChangePassword").on("click",function(f){f.preventDefault();d("#modalPassword").modal().on("hide.bs.modal",function(){d(this).find("form").remove()});d("#modalPassword .modal-body").empty().load(Routing.generate("app_user_changepassword"),function(){d("#modalPassword form").validate({messages:{"form[current_password]":{remote:Translator.trans("Wrong password")}},rules:{"form[current_password]":{remote:{url:Routing.generate("app_user_checkpassword"),type:"post",data:{password:function(){return d("#form_current_password").val()}}}},"form[plainPassword][first]":"validpassword","form[plainPassword][second]":{equalTo:"#form_plainPassword_first"}},errorPlacement:function(g,h){if(!h.data("tooltipster-ns")){h.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}h.tooltipster("update",d(g).text());h.tooltipster("show")},success:function(g,h){d(h).tooltipster("hide")},submitHandler:function(){d("#modalPassword form").ajaxSubmit({dataType:"json",beforeSubmit:function(){d("#modalPassword button[type=button]:last").hide()},success:function(g){if(g.result=="success"){d("#modalPassword .modal-body").empty().append(d("<div/>").addClass("alert alert-success").text(Translator.trans("Password changed successfully!")))}else{d("#modalPassword .modal-body").empty().append(d("<div/>").addClass("alert alert-warning").text(Translator.trans("Password coold not be changed.")))}d("#modalPassword button[type=button]:first").text("Close")}})}});d("#modalPassword button[type=button]").show()})})};var e=function(f){swal({title:Translator.trans("Notification"),text:f})};return{init:function(){c();b();a()},alert:e}}(jQuery));+(App.Forms=function(b){var a=function(){var d=function(f){f.preventDefault();b(this).closest(".item").fadeOut(function(){var g=b(this).closest(".collection");b(this).remove();g.trigger("item-removed.app")})};var e=function(i){var j=b(this).parent().parent().find(".collection:first"),h=j.data("prototype"),g=j.data("index");if(j.length==0||typeof h=="undefined"||typeof g=="undefined"){return}var f=b(h.replace(/__name__/g,g));j.data("index",g+1);j.append(f);b(f.find("input:text:visible, select:visible, textarea:visible")[0]).focus();j.trigger("item-added.app",{index:g,item:f})};b("body").on("click",".btn-add-item",e);b("body").on("click",".btn-remove-item",d);b(".collection").each(function(){var f=b(this);f.data("index",f.find(">.item").length)})};var c=function(e,d){b(e).intlTelInput(b.extend({},{allowExtensions:true,autoFormat:false,autoHideDialCode:true,autoPlaceholder:false,defaultCountry:"auto",geoIpLookup:function(f){b.get("http://ipinfo.io",function(){},"jsonp").always(function(h){var g=(h&&h.country)?h.country:"";f(g)})},nationalMode:false,numberType:"MOBILE",preferredCountries:["us","ca","cu"],utilsScript:phone_util_script_url},d))};return{init:function(){a()},initTelephoneControl:c}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Bookings=typeof App.Bookings!=="undefined"?App.Bookings:{};+(App.Bookings.Index=function(a){var b=function(){var e=a("#datatable-offers");var h=function(j){j.preventDefault();var k=a(this),i=k.attr("href");swal({title:Translator.trans("Confirm operation"),text:Translator.trans("The record will be cancelled. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(l){if(l){k.closest("td").text(Translator.trans("Updating...")).closest("tr").addClass("row-removing");a.ajax(i,{dataType:"json",method:"post",success:function(m){e.dataTable().api().draw(false)}})}})};var d=function(j){j.preventDefault();var k=a(this),i=k.attr("href");k.closest("td").text(Translator.trans("Updating...")).closest("tr").addClass("row-removing");a.ajax(i,{dataType:"json",method:"POST",success:function(l){e.dataTable().api().draw(false)}})};var c=function(j){j.preventDefault();var i=a(this).attr("href"),k=a(this);swal({title:Translator.trans("Confirm removal"),text:Translator.trans("The record will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(l){if(l){if(confirm("Are you sure you want to continue with removal?")){k.closest("td").text(Translator.trans("Removing...")).closest("tr").addClass("row-removing");a.ajax(i,{dataType:"json",method:"post",success:function(m){e.find("tr.row-removing").remove();e.dataTable().api().draw(false)}})}}})};var f=function(j){j.preventDefault();var i=a(this).attr("href"),k=a(this);swal({title:Translator.trans("Confirm move"),text:Translator.trans("The record will be moved to the official operation. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#337ab7"},function(l){if(l){k.closest("td").text(Translator.trans("Moving...")).closest("tr").addClass("row-promoting");a.ajax(i,{dataType:"json",method:"post",success:function(m){e.find("tr.row-promoting").remove();e.dataTable().api().draw(false)}})}})};var g=function(j){j.preventDefault();var i=a(this).attr("href"),k=a(this);swal({title:Translator.trans("Confirm move"),text:Translator.trans("The record will be pulled off from the operation. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#337ab7"},function(l){if(l){k.closest("td").text(Translator.trans("Moving...")).closest("tr").addClass("row-promoting");a.ajax(i,{dataType:"json",method:"POST",success:function(m){e.find("tr.row-promoting").remove();e.dataTable().api().draw(false)}})}})};e.on("click","a.btn-promote",f);e.on("click","a.btn-unpromote",g);e.on("click","a.btn-delete",c);e.on("click","a.btn-cancel",h);e.on("click","a.btn-uncancel",d);e.dataTable({order:[[4,"asc"]],columnDefs:[{searchable:false,sortable:false,targets:[5],width:"158px",title:Translator.trans("Actions")},{name:"version",searchable:false,sortable:false,targets:[0],title:"V",width:"20px"},{name:"state",searchable:false,targets:[1],title:Translator.trans("State"),width:"35px"},{name:"name",targets:[2],title:Translator.trans("Name")},{name:"client",targets:[3],title:Translator.trans("Client")},{name:"startAt",searchable:false,targets:[4],title:Translator.trans("Date")}],processing:true,serverSide:true,ajax:{method:"post",url:Routing.generate("app_offers_getdata"),data:function(i){return a.extend(true,i,{filter:{state:a('form#filter select[name$="[state]"]').val(),cancelled:a('form#filter select[name$="[cancelled]"]').val(),fromDate:a('form#filter input:text[name$="[fromDate]"]').val(),toDate:a('form#filter input:text[name$="[toDate]"]').val()}})}}});+(function(){a('form#filter input[name$="[fromDate]"]').parent().datetimepicker({format:"DD/MM/YYYY"});a('form#filter input[name$="[toDate]"]').parent().datetimepicker({format:"D/MM/YYYY",useCurrent:false});a('form#filter input[name$="[fromDate]"]').parent().on("dp.change",function(i){a('form#filter input[name$="[toDate]"]').parent().data("DateTimePicker").minDate(i.date);e.DataTable().draw(false)});a('form#filter input[name$="[toDate]"]').parent().on("dp.change",function(i){a('form#filter input[name$="[fromDate]"]').parent().data("DateTimePicker").maxDate(i.date);e.DataTable().draw(false)});a("form#filter select").on("change",function(){e.DataTable().draw(false)})}())};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Clients=typeof App.Clients!=="undefined"?App.Clients:{};+(App.Clients.Index=function(a){var b=function(){var c=a("#datatable-clients");c.dataTable({order:[[0,"asc"]],columnDefs:[{orderable:false,sortable:false,targets:[1]},{name:"fullname",targets:[0]}],dom:"lfrtip",processing:true,serverSide:true,ajax:{method:"POST",url:Routing.generate("app_clients_getdata")}});c.on("draw.dt",function(){a(this).find("a.btn-delete").on("click",function(e){e.preventDefault();var d=a(this).attr("href"),f=a(this);swal({title:Translator.trans("Confirm remove"),text:Translator.trans("The record will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(g){if(g){f.closest("td").text(Translator.trans("Removing...")).closest("tr").addClass("row-removing");a.ajax(d,{dataType:"json",method:"post",success:function(h){c.find("tr.row-removing").remove();swal({title:Translator.trans("Notification"),text:Translator.trans("Client has been removed successfuly")});c.dataTable().api().draw(false)}})}})})})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Contracts=typeof App.Contracts!=="undefined"?App.Contracts:{};+(App.Contracts.Index=function(a){var b=function(){var c=a("#datatable-x");c.dataTable({order:[[1,"asc"]],aoColumns:[{sortable:false,searchable:false},{name:"name"},{name:"model"},{name:"supplier"},{name:"signedAt"},{name:"startAt"},{name:"endAt"},{sortable:false,searchable:false,width:80}],serverSide:true,processing:true,ajax:{method:"POST",url:Routing.generate("app_contracts_getdata")}});c.on("draw.dt",function(){a(this).find("input").iCheck({checkboxClass:"icheckbox_flat-green"});a(this).find("a.btn-delete").on("click",function(e){e.preventDefault();var d=a(this).attr("href"),f=a(this);swal({title:Translator.trans("Confirm remove"),text:Translator.trans("The record will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(g){if(g){f.closest("td").text(Translator.trans("Removing...")).closest("tr").addClass("row-removing");a.ajax(d,{dataType:"json",method:"post",success:function(h){c.find("tr.row-removing").remove();c.dataTable().api().draw(false)}})}})})})};return{init:function(){b()}}}(jQuery));
(function(c,b){var a=function(g,d,e){var h;return function f(){var k=this,j=arguments;function i(){if(!e){g.apply(k,j)}h=null}if(h){clearTimeout(h)}else{if(e){g.apply(k,j)}}h=setTimeout(i,d||100)}};jQuery.fn[b]=function(d){return d?this.bind("resize",a(d)):this.trigger(b)}})(jQuery,"smartresize");var CURRENT_URL=window.location.href.split("#")[0].split("?")[0],$BODY=$("body"),$MENU_TOGGLE=$("#menu_toggle"),$SIDEBAR_MENU=$("#sidebar-menu"),$SIDEBAR_FOOTER=$(".sidebar-footer"),$LEFT_COL=$(".left_col"),$RIGHT_COL=$(".right_col"),$NAV_MENU=$(".nav_menu"),$FOOTER=$("footer");$(document).ready(function(){var a=function(){$RIGHT_COL.css("min-height",$(window).height());var d=$BODY.outerHeight(),b=$BODY.hasClass("footer_fixed")?-10:$FOOTER.height(),e=$LEFT_COL.eq(1).height()+$SIDEBAR_FOOTER.height(),c=d<e?e:d;c-=$NAV_MENU.height()+b;$RIGHT_COL.css("min-height",c)};$SIDEBAR_MENU.find("a").on("click",function(b){var c=$(this).parent();if(c.is(".active")){c.removeClass("active active-sm");$("ul:first",c).slideUp(function(){a()})}else{if(!c.parent().is(".child_menu")){$SIDEBAR_MENU.find("li").removeClass("active active-sm");$SIDEBAR_MENU.find("li ul").slideUp()}c.addClass("active");$("ul:first",c).slideDown(function(){a()})}});$MENU_TOGGLE.on("click",function(){if($BODY.hasClass("nav-md")){$SIDEBAR_MENU.find("li.active ul").hide();$SIDEBAR_MENU.find("li.active").addClass("active-sm").removeClass("active")}else{$SIDEBAR_MENU.find("li.active-sm ul").show();$SIDEBAR_MENU.find("li.active-sm").addClass("active").removeClass("active-sm")}$BODY.toggleClass("nav-md nav-sm");a()});$SIDEBAR_MENU.find('a[href*="'+CURRENT_URL+'"]:first').parent("li").addClass("current-page");$SIDEBAR_MENU.find("a").filter(function(){return this.href!==""&&CURRENT_URL.search(this.href)!==-1}).parent("li").addClass("current-page").parents("ul").slideDown(function(){a()}).parent().addClass("active");$(window).smartresize(function(){a()});a();if($.fn.mCustomScrollbar){$(".menu_fixed").mCustomScrollbar({autoHideScrollbar:true,theme:"minimal",mouseWheel:{preventDefault:true}})}});$(document).ready(function(){$("body").on("click",".collapse-link",function(){var a=$(this).closest(".x_panel"),b=$(this).find("i"),c=a.find(".x_content");if(a.css("style")){c.slideToggle(200,function(){a.removeAttr("style")})}else{c.slideToggle(200);a.css("height","auto")}b.toggleClass("fa-chevron-up fa-chevron-down")});$(".close-link").click(function(){var a=$(this).closest(".x_panel");a.remove()})});$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})});if($(".progress .progress-bar")[0]){$(".progress .progress-bar").progressbar()}$(document).ready(function(){if($(".js-switch")[0]){var a=Array.prototype.slice.call(document.querySelectorAll(".js-switch"));a.forEach(function(b){var c=new Switchery(b,{color:"#26B99A"})})}});$("table input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$("table input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});var checkState="";$(".bulk_action input").on("ifChecked",function(){checkState="";$(this).parent().parent().parent().addClass("selected");countChecked()});$(".bulk_action input").on("ifUnchecked",function(){checkState="";$(this).parent().parent().parent().removeClass("selected");countChecked()});$(".bulk_action input#check-all").on("ifChecked",function(){checkState="all";countChecked()});$(".bulk_action input#check-all").on("ifUnchecked",function(){checkState="none";countChecked()});function countChecked(){if(checkState==="all"){$(".bulk_action input[name='table_records']").iCheck("check")}if(checkState==="none"){$(".bulk_action input[name='table_records']").iCheck("uncheck")}var a=$(".bulk_action input[name='table_records']:checked").length;if(a){$(".column-title").hide();$(".bulk-actions").show();$(".action-cnt").html(a+" Records Selected")}else{$(".column-title").show();$(".bulk-actions").hide()}}$(document).ready(function(){$(".expand").on("click",function(){$(this).next().slideToggle(200);$expand=$(this).find(">:first-child");if($expand.text()=="+"){$expand.text("-")}else{$expand.text("+")}})});if(typeof NProgress!="undefined"){$(document).ready(function(){NProgress.start()});$(window).load(function(){NProgress.done()})};
App=typeof App!=="undefined"?App:{};App.ReceivableAccounts=typeof App.ReceivableAccounts!=="undefined"?App.ReceivableAccounts:{};+(App.ReceivableAccounts.Index=function(a){var b=function(){var c=a("#datatable-x");c.on("click",".btn-change-state",function(e){e.preventDefault();var d=a(".modal#modal-change");d.data("process",a(this));a(this).attr("disabled","disabled");d.modal();d.find(".modal-content").empty().append(a('<div class="modal-body"><p>'+Translator.trans("Loading data...")+"</p></div>")).load(a(this).attr("href"),function(){d.data("process").removeAttr("disabled");d.find("form").ajaxForm({dataType:"json",success:function(g){d.modal("hide");a(d.data("process")).parent().text(Translator.trans("Updating..."));c.dataTable().api().draw(false)}});var f=d.find(".collection");f.data("index",f.find(".item").length);d.find(".btn-add-item").on("click",function(){var i=d.find(".collection"),h=i.data("prototype"),g=i.data("index");$item=a(h.replace(/__name__/g,g)).appendTo(i);i.data("index",g+1)})})});c.on("click",".btn-view",function(f){f.preventDefault();var d=a(".modal#modal-view"),e=a(this).data("cancel-url");d.modal();d.find(".modal-content").empty().load(a(this).attr("href"),function(){d.find("a.btn-danger").attr("href",e)})});c.dataTable({order:[[2,"desc"]],aoColumns:[{name:"client"},{name:"name"},{name:"startAt",searchable:false},{name:"endAt",searchable:false},{name:"price",searchable:false},{name:"date"},{name:"notes"},{sortable:false,searchable:false}],serverSide:true,processing:true,ajax:{method:"POST",url:Routing.generate("app_cxcobrar_getdata"),data:function(d){return a.extend({},d,{filter:{state:a('form#filter select[name$="[state]"]').val()}})}}});a("form#filter select").on("change",function(){c.dataTable().api().draw(true)})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.PayableAccounts=typeof App.PayableAccounts!=="undefined"?App.PayableAccounts:{};+(App.PayableAccounts.Index=function(a){var b=function(){var c=a("#datatable-x");c.on("click",".btn-change-state",function(e){e.preventDefault();var d=a(".modal#modal-change");d.find(".modal-content").empty().load(a(this).attr("href"),function(){d.find("form").ajaxForm({beforeSubmit:function(){d.find("button[type=submit]").text(Translator.trans("Saving...")).attr("disabled","disabled")},dataType:"json",success:function(g){d.modal("hide");c.dataTable().api().draw(true)}});var f=d.find(".collection");f.data("index",f.find(".item").length);d.find(".btn-add-item").on("click",function(){var h=f.data("index"),g=f.data("prototype");f.append(a(g.replace(/__name__/g,h)));f.data("index",h+1)})});d.modal()});c.on("click",".btn-view",function(e){e.preventDefault();var d=a(".modal#modal-view");d.modal();d.find(".modal-content").empty().load(a(this).attr("href"))});a(".modal#modal-change button.btn-primary").on("click",function(){a(this).attr("disabled","disabled").text(Translator.trans("Saving..."));a.ajax(a(".modal#modal-change").data("record-url"),{data:{notes:a(".modal#modal-change textarea").val()},dataType:"json",method:"POST",success:function(d){c.dataTable().api().draw(false);swal({title:Translator.trans("Success"),text:Translator.trans("Operation done successfuly.")});a(".modal#modal-change").modal("hide")}})});c.dataTable({order:[[3,"asc"]],aoColumns:[{name:"client"},{name:"name"},{name:"service"},{name:"startAt",searchable:false},{name:"endAt",searchable:false},{name:"supplier"},{name:"date",searchable:false},{name:"notes"},{sortable:false,searchable:false}],serverSide:true,processing:true,ajax:{method:"post",url:Routing.generate("app_cxpagar_getdata"),data:function(d){return a.extend({},d,{filter:{state:a('form#filter select[name$="[state]"]').val()}})}}});a("form#filter select").on("change",function(){c.dataTable().api().draw(true)})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Bookings=typeof App.Bookings!=="undefined"?App.Bookings:{};+(App.Bookings.Form=function(c){var e=function(){c('input:radio[name="offer_form[clientType]"]').on("ifClicked",function(){var f=c(this).val();if(f==="direct"){c(".block-clienttype.block-clienttype-direct").show();c(".block-clienttype:not(.block-clienttype-direct)").find("input:text, select").each(function(){if(c(this).data("tooltipster-ns")){c(this).tooltipster("hide")}});c(".block-clienttype:not(.block-clienttype-direct)").hide()}else{if(f==="registered"){c(".block-clienttype.block-clienttype-registered").show();c(".block-clienttype:not(.block-clienttype-registered)").find("input:text, select").each(function(){if(c(this).data("tooltipster-ns")){c(this).tooltipster("hide")}});c(".block-clienttype:not(.block-clienttype-registered)").hide()}}});c("#offer_form_client").select2({width:"100%"});c("#offer_form_client").on("change",function(){c("#offer_form_notificationContact").empty();var f=c(this).val();c.getJSON(Routing.generate("app_offers_getclientcontacts")+"?client="+f,function(g){c("#offer_form_notificationContact").append(c('<option value=""></option>'));c.each(g.elements,function(h,j){c("#offer_form_notificationContact").append(c('<option value="'+j.id+'">'+j.text+"</option>"))})})});App.Forms.initTelephoneControl(c("#offer_form_directClientMobilePhone"));c("body").on("click",".btn-search-service",function(){var f=c(this).closest(".item");c("#searchServiceModal").data("item",f).modal({backdrop:"static"});c("#searchServiceModal .modal-body").empty().append(c("<p>"+Translator.trans("Loading data...")+"</p>")).load(Routing.generate("app_offers_searchservice"),d)});c("body").on("change",'.item.item-service select[name$="[model]"]',function(){var f=c(this).closest(".item"),h=this.options[this.selectedIndex];var g=c(h).data("options")?c(h).data("options").split(" "):[];c.each(g,function(j){var k=g[j];if(k.substr(0,1)==="-"){f.find(".visible-"+k.substr(1)).hide()}else{f.find(".visible-"+(k.substr(0,1)=="+"?k.substr(1):k)).show()}});f.find('input[name$="[cost]"]').trigger("change")});c('.item.item-service select[name$="[model]"]').trigger("change");+(function(){var g=function(j){return isNaN(parseFloat(j))?0:parseFloat(j)};var i=function(p){var o=c(p),l=o.find('input[name$="[nights]"]'),q=o.find('input[name$="[pax]"]'),k=o.find('input[name$="[cost]"]'),m=o.find('input[name$="[totalPrice]"]'),r=l.is(":visible")?g(l.val()):0,j=q.is(":visible")?g(q.val()):0,n=r*g(k.val())+j*g(k.val());m.val(n.toFixed(2))};var f=function(){var j=new Number(0);c('.item-service input[name$="[totalPrice]"]').each(function(){j+=g(c(this).val())});c("#offer_form_totalExpenses").val(j.toFixed(2)).trigger("change")};c("#offer_form_services").on("change",'input[name$="[nights]"], input[name$="[pax]"], input[name$="[cost]"]',function(){i(c(this).closest(".item-service"))});c("#offer_form_services").on("change",'.item-service input[name$="[totalPrice]"]',function(){f()});c(".item-administrative-charge").on("change","input",function(){if(!c(this).is('[name$="[pax]"], [name$="[multiplier]"], [name$="[price]"]')){return}var j=c(this).closest(".item"),k=g(j.find('input[name$="[multiplier]"]').val())*g(j.find('input[name$="[pax]"]').val())*g(j.find('input[name$="[price]"]').val());c(this).closest(".item").find('input[name$="[total]"]').val(k.toFixed(2)).trigger("change")});var h=function(){var j=c("#offer_form_totalCharges"),l=c('.item-administrative-charge input[name$="[total]"]'),k=new Number(0);l.each(function(){k+=g(c(this).val())});j.val(k.toFixed(2)).trigger("change")};c(".item-administrative-charge").on("change",'input[name$="[total]"]',function(){h()});c("#offer_form_totalExpenses, #offer_form_totalCharges, #offer_form_percentApplied_percent, #offer_form_percentApplied_plus").on("change",function(){var j=c("#offer_form_totalExpenses, #offer_form_totalCharges, #offer_form_percentApplied_percent, #offer_form_percentApplied_plus");var m=g(c("#offer_form_totalExpenses").val()),k=g(c("#offer_form_totalCharges").val()),n=c("#offer_form_percentApplied_percent"),l;if(n.val()==="plus"){l=new Number(m+k+g(c("#offer_form_percentApplied_plus").val()))}else{l=new Number(m*(n.val()/100)+m+k)}c("#offer_form_clientCharge").val(l.toFixed(2))});c("#offer_form_totalExpenses").trigger("change");c("#offer_form_percentApplied_percent").on("change",function(){if(c(this).val()!=="plus"){c("#offer_form_percentApplied_plus").val(0)}});f();h()}())};var b=function(){var f=function(j,l){var m=j.find('input[name$="[nights]"]'),n=j.find("input.datepicker"),k=c.now();if(m.data("ajax")){m.data("ajax").abort()}if(c(n[0]).val()==""){return}if(c(l).is(".datepicker")){if(c(n[1]).val()==""){m.val("");return}var o=c.ajax(Routing.generate("app_offers_getnights")+"?id="+k,{data:{from:c(n[0]).val(),to:c(n[1]).val()},dataType:"json",method:"POST",success:function(p){m.val(p.nights);m.removeData("ajax")}})}else{if(c(l).val()==""){c(n[1]).val("");return}var o=c.ajax(Routing.generate("app_offers_getnights")+"?id="+k,{data:{from:c(n[0]).val(),nights:m.val()},dataType:"json",method:"POST",success:function(p){c(n[1]).val(p.to);m.removeData("ajax")}})}m.data("ajax",o)};var h=function(l){var k=c(l).find("input.datepicker"),j={format:"DD/MM/YYYY HH:mm",showClear:true,showTodayButton:true};c(k[0]).parent().datetimepicker(j);c(k[1]).parent().datetimepicker(c.extend({},j,{useCurrent:false}));c(k[0]).parent().on("dp.change",function(m){c(k[1]).parent().data("DateTimePicker").minDate(m.date);f(c(l),k[0])});c(k[1]).parent().on("dp.change",function(m){c(k[0]).parent().data("DateTimePicker").maxDate(m.date);f(c(l),k[1])})};var g=function(j){c(j).find('select[name$="[origin]"], select[name$="[destination]"]').select2({minimunInputLength:1,width:"100%",ajax:{url:Routing.generate("app_offers_getplaces"),dataType:"json",delay:250,method:"GET",data:function(k){return{q:k.term,page:k.page}},processResults:function(k){var l=k.data;l.unshift({id:0,text:""});return{results:l}}}})};var i=function(j){c(j).find('select[name$="[supplier]"]').select2({width:"100%"})};c(".item.item-service").each(function(){h(this);g(this);i(this)});c("body").on("change",'.item-service input[name$="[nights]"]',function(){f(c(this).closest(".item"),this)});c("body").on("click",".btn-add-item",function(o){var n=c(this);if(n.is("a")){o.preventDefault()}var p=c(n.data("collection")),l=p.data("index"),k=p.data("prototype");$counter=p.data("counter")?c(p.data("counter")):null;$item=c(k.replace(/__name__/g,l));p.data("index",l+1);if($counter){$counter.val(parseInt($counter.val(),10)+1)}p.append($item);if($item.is(".item-service")){if(p.find(".item-service").length>1){var j=$item.prev();for(var m=0;m<2;m++){if(j.find(".datepicker:eq("+m+")").val()!==""){$item.find(".datepicker:eq("+m+")").val(j.find(".datepicker:eq("+m+")").val())}}}$item.find('select[name$="[model]"]').trigger("change");h($item);g($item);i($item)}$item.find("input:text:first").focus();if(p.closest("div.x_panel").find("h2").data("tooltipster-ns")){p.closest("div.x_panel").find("h2").tooltipster("hide")}c("body").animate({scrollTop:$item.offset().top},500)});c("body").on("click",".btn-remove-item",function(l){var k=c(this),j=k.closest(".item");if(k.is("a")){l.preventDefault()}swal({title:Translator.trans("Confirm operation"),text:Translator.trans("The service will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(m){if(m){j.fadeOut(function(){var o=c(this).closest(".collection"),n=o.data("counter")?c(o.data("counter")):null;c(this).remove();if(n){n.val(n.val()-1)}})}})})};var a=function(){c("#reservation").validate({errorPlacement:function(f,g){if(g.is(":hidden")){g=g.closest(":visible")}if(!g.data("tooltipster-ns")){g.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}g.tooltipster("update",c(f).text());g.tooltipster("show")},ignore:':hidden:not(input[name="servicesCounter"])',messages:{servicesCounter:{min:Translator.trans("Add a service at least")}},rules:{servicesCounter:{min:1},"offer_form[directClientFullName]":{required:{depends:function(){return c("#offer_form_clientType_1").prop("checked")===true}}},"offer_form[client]":{required:{depends:function(){return c("#offer_form_clientType_0").prop("checked")===true}}},"offer_form[percentApplied][plus]":"number"},success:function(g,h){var f=c(h);if(f.is(":hidden")){f=f.closest(":visible")}f.tooltipster("hide")}})};var d=function(){var j=c("#searchServiceModal");j.on("preDraw.dt","table",function(){c(this).parent().block({message:"Loading services..."})}).on("draw.dt","table",function(){c(this).parent().unblock()});var g={initDatepickers:function(o,n,p){var m={format:"DD/MM/YYYY",showClear:true,showTodayButton:true};o.datetimepicker(m);n.datetimepicker(c.extend({},m,{useCurrent:false}));o.on("dp.change",function(q){n.data("DateTimePicker").minDate(q.date);p()});n.on("dp.change",function(q){o.data("DateTimePicker").maxDate(q.date);p()})},translateResults:function(n,m){var o=function(p){return n.find('[name$="['+p+']"]')};o("model").val(m.model).trigger("change");c.each(m,function(p,q){o(p).val(q)})}};var f=function(){var o=j.find("#tab-hotel"),m=o.find("table.table-results");m.dataTable({serverSide:true,ajax:{url:Routing.generate("app_offers_gethotelprices"),data:function(p){return c.extend({},p,{filter:{from:o.find("input:text.datepicker:first").val(),to:o.find("input:text.datepicker:last").val(),pax:o.find('select[name$="[pax]"]').val(),plan:o.find('select[name$="[plan]"]').val(),quantity:o.find('select[name$="[quantity]"]').val()}})},method:"POST"},aoColumns:[{name:"hotel",title:Translator.trans("Hotel")},{name:"room",title:Translator.trans("Room")},{name:"seasson",title:Translator.trans("Season")},{name:"plan",title:Translator.trans("Plan")},{name:"pax",title:Translator.trans("Pax")},{name:"price",title:Translator.trans("Price")},{name:"total",title:Translator.trans("Total")},{sortable:false,searchable:false,width:"40px"}]});var n=function(){m.dataTable().api().draw()};m.on("click","button.btn-select-service",function(){var q=c(this).data("service");j.modal("hide");var p=j.data("item");g.translateResults(p,{model:"hotel",startAt:o.find("input.datepicker:first").val()+" 08:00",endAt:o.find("input.datepicker:last").val()+" 08:00",name:q.serviceName,facilityName:q.hotel,nights:q.nights,supplier:q.supplier.id,pax:q.pax,supplierNotes:q.plan,cost:q.cost,totalPrice:q.totalPrice});p.find('select[name$="[supplier]"]').trigger("change.select2");p.find('input[name$="[totalPrice]"]').trigger("change")});o.find("form .date:first").on("dp.change",function(q){var s=q.date?q.date.clone():null,r=o.find("form input.datepicker:last").val()?moment(o.find("form input.datepicker:last").val(),"DD/MM/YYYY"):null;if(!s||!r){o.find("form input[name=nights]").val("")}else{var p=r.startOf("day").diff(s.startOf("day"),"days");o.find("form input[name=nights]").val(p)}});o.find("form .date:last").on("dp.change",function(q){var s=o.find("form input.datepicker:first").val()?moment(o.find("form input.datepicker:first").val(),"DD/MM/YYYY"):null,r=q.date?q.date.clone():null;if(!s||!r){o.find("form input[name=nights]").val("")}else{var p=r.startOf("day").diff(s.startOf("day"),"days");o.find("form input[name=nights]").val(p)}});o.find("input[name=nights]").on("change",function(){var q=o.find("form input.datepicker:first").val()?moment(o.find("form input.datepicker:first").val(),"DD/MM/YYYY"):null,p=c(this).val();if(""===p){o.find("form input.datepicker:last").val("")}else{q.add(p,"days");o.find("form input.datepicker:last").val(q.format("DD/MM/YYYY"))}n()});g.initDatepickers(o.find("input.datepicker:first").parent(),o.find("input.datepicker:last").parent(),n);o.find("select").on("change",function(){n()});j.find("a[role=tab][aria-controls=tab-hotel]").on("shown.bs.tab",function(){n()})};var l=function(){$tab=j.find("#tab-private-house");var m=function(){var n=$tab.find(".table-responsive"),o={from:$tab.find("input:text.datepicker:first").val(),to:$tab.find("input:text.datepicker:last").val(),quantity:$tab.find('select[name="quantity"]').val(),address:$tab.find('input[name="address"]').val(),plan:$tab.find('select[name="plan"]').val()};n.empty().append(Translator.trans("Loading services...")).load(Routing.generate("app_offers_getprivatehouseprices"),o,function(){n.find("table").DataTable()})};$tab.find("form .date:first").on("dp.change",function(o){var q=o.date?o.date.clone():null,p=$tab.find("form input.datepicker:last").val()?moment($tab.find("form input.datepicker:last").val(),"DD/MM/YYYY"):null;if(!q||!p){$tab.find("form input[name=nights]").val("")}else{var n=p.startOf("day").diff(q.startOf("day"),"days");$tab.find("form input[name=nights]").val(n)}});$tab.find("form .date:last").on("dp.change",function(o){var q=$tab.find("form input.datepicker:first").val()?moment($tab.find("form input.datepicker:first").val(),"DD/MM/YYYY"):null,p=o.date?o.date.clone():null;if(!q||!p){$tab.find("form input[name=nights]").val("")}else{var n=p.startOf("day").diff(q.startOf("day"),"days");$tab.find("form input[name=nights]").val(n)}});$tab.find("input[name=nights]").on("change",function(){var o=$tab.find("form input.datepicker:first").val()?moment($tab.find("form input.datepicker:first").val(),"DD/MM/YYYY"):null,n=c(this).val();if(""===n){$tab.find("form input.datepicker:last").val("")}else{o.add(n,"days");$tab.find("form input.datepicker:last").val(o.format("DD/MM/YYYY"))}m()});g.initDatepickers($tab.find("input.datepicker:first").parent(),$tab.find("input.datepicker:last").parent(),m);$tab.find("form#filter-private-house").find("input:not(.datepicker, [name=nights]), select").on("change",function(){m()});j.find("a[role=tab][aria-controls=tab-private-house]").on("shown.bs.tab",function(){m()});$tab.on("click","button.btn-select-service",function(){var o=c(this).data("service"),n=j.data("item");g.translateResults(n,{model:"private-house",startAt:$tab.find("input.datepicker:first").val()+" 08:00",endAt:$tab.find("input.datepicker:last").val()+" 08:00",name:o.service,supplier:o.supplier.id,facilityName:o.supplier.name,nights:o.nights,pax:1,cost:o.cost,totalPrice:o.totalPrice,supplierNotes:o.supplierNotes});n.find('[name$="[supplier]"]').trigger("change.select2");n.find('[name$="[totalPrice]"]').trigger("change");j.modal("hide")})};var i=function(){var n=j.find("#tab-car-rental"),m=function(){var o=n.find(".table-responsive"),p={from:n.find("input:text.datepicker:first").val(),to:n.find("input:text.datepicker:last").val(),quantity:n.find('select[name="quantity"]').val(),cartype:n.find('select[name="cartype"]').val()};o.empty().append(Translator.trans("Loading services...")).load(Routing.generate("app_offers_getcarrentalprices"),p,function(){o.find("table").DataTable()})};g.initDatepickers(n.find("input.datepicker:first").parent(),n.find("input.datepicker:last").parent(),m);n.find("form#filter-car-rental").find("input:not(.datepicker), select").on("change",function(){m()});j.find("a[role=tab][aria-controls=tab-car-rental]").on("shown.bs.tab",function(){m()});n.on("click","button.btn-select-service",function(){var p=c(this).data("service"),o=j.data("item");g.translateResults(o,{model:"car-rental",startAt:n.find("input.datepicker:first").val()+" 08:00",endAt:n.find("input.datepicker:last").val()+" 08:00",name:p.name,supplier:p.supplier.id,rentCar:p.carType,cost:p.cost,totalPrice:p.totalPrice});o.find('[name$="[supplier]"]').trigger("change.select2");o.find('[name$="[totalPrice]"]').trigger("change");j.modal("hide")})};var k=function(){var o=j.find("#tab-transport"),n=function(){o.find(".table-results").dataTable({serverSide:true,aoColumns:[{name:"service",title:Translator.trans("Service")},{name:"supplier",title:Translator.trans("Supplier")},{name:"price",title:Translator.trans("Price")},{name:"total",title:Translator.trans("Total")},{sortable:false,searchable:false,width:"40px"}],ajax:{url:Routing.generate("app_offers_gettransportprices"),method:"POST",data:function(p){console.log(o.find("input:checkbox").prop("checked"));return c.extend({},p,{filter:{from:o.find("input:text.datepicker:first").val(),to:o.find("input:text.datepicker:last").val(),quantity:o.find('select[name="quantity"]').val(),addhalfday:o.find("input:checkbox").prop("checked")==true?1:0}})}}})},m=function(){if(o.find(".table-results tbody").length>0){o.find("table.table-results").dataTable().api().draw()}else{n()}};o.find("form input:checkbox").iCheck({checkboxClass:"icheckbox_flat-green"});o.find("form input:checkbox").on("ifChanged",function(){m()});g.initDatepickers(o.find("input.datepicker:first").parent(),o.find("input.datepicker:last").parent(),m);o.find("form#filter-transport").find("input:not(.datepicker), select").on("change",function(){m()});j.find("a[role=tab][aria-controls=tab-transport]").on("shown.bs.tab",function(){m()});o.on("click","button.btn-select-service",function(){var q=c(this).data("service"),p=j.data("item");g.translateResults(p,{model:"transport",startAt:o.find("input.datepicker:first").val()+" 08:00",endAt:o.find("input.datepicker:last").val()+" 08:00",name:q.name,supplier:q.supplier.id,cost:q.cost,totalPrice:q.totalPrice});p.find('[name$="[supplier]"]').trigger("change.select2");p.find('[name$="[totalPrice]"]').trigger("change");j.modal("hide")})};var h=function(){j.find(".tab-content .tab-pane:not(#tab-hotel, #tab-private-house, #tab-car-rental, #tab-transport)").each(function(){var o=c(this),m=o.attr("id").replace(/^tab\-/,""),n=function(){var p={model:m,from:o.find("input.datepicker:first").val(),to:o.find("input.datepicker:last").val(),quantity:o.find("select[name=quantity]").val()};o.find(".table-responsive.results").empty().text(Translator.trans("Loading services...")).load(Routing.generate("app_offers_getgeneralserviceprices"),p,function(){o.find(".table-responsive.results table").DataTable({})})};g.initDatepickers(o.find(".date:has(.datepicker):first"),o.find(".date:has(.datepicker):last"),n);o.find("form").find("select, input:not(.datepicker)").on("change",function(){n()});o.on("click","button.btn-select-service",function(){var q=c(this).data("service"),p=j.data("item");j.modal("hide");g.translateResults(p,{model:m,startAt:o.find("input.datepicker:first").val(),endAt:o.find("input.datepicker:last").val(),name:q.serviceName,supplier:q.supplier.id,pax:q.pax,cost:q.cost,totalPrice:q.totalPrice});p.find('[name$="[supplier]"]').trigger("change.select2");p.find('[name$="[totalPrice]"]').trigger("change")});j.find("a[role=tab][aria-controls=tab-"+m+"]").on("show.bs.tab",function(){n()})})};f();l();i();k();h()};return{init:function(){e();b();a();d()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Clients=typeof App.Clients!=="undefined"?App.Clients:{};+(App.Clients.Form=function(a){var b=function(){+(function(){a(".collection").each(function(){var d=a(this),c=d.find("> .item").length;d.data("index",c)});a("body").on("click",".btn-add-item",function(f){f.preventDefault();var g=a(this).parent().parent().find(".collection"),e=g.data("prototype"),d=g.data("index"),c=a(e.replace(/__name__/g,d));g.append(c);c.find("input:text:first").focus();g.data("index",d+1);a('input:hidden[name="contactCounter"]').val(a("#client_form_contacts").find(".item").length);App.Forms.initTelephoneControl(c.find("input[type=tel]"))});a("body").on("click",".btn-delete-item",function(c){c.preventDefault();a(this).closest(".item").fadeOut(function(){a(this).remove();a('input:hidden[name="contactCounter"]').val($container.find(".item").length)})})}());App.Forms.initTelephoneControl(a("input[type=tel]"));a("form#client").validate({errorPlacement:function(c,d){if(d.is(":hidden")){d=d.closest(":visible")}if(!d.data("tooltipster-ns")){d.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}d.tooltipster("update",a(c).text());d.tooltipster("show")},messages:{contactCounter:{min:Translator.trans("Client has no contact person")}},rules:{contactCounter:{min:1}},ignore:":hidden:not(input[name=contactCounter])",success:function(c,d){if(a(d).is(":hidden")){d=a(d).closest(":visible")}a(d).tooltipster("hide")}})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Contracts=typeof App.Contracts!=="undefined"?App.Contracts:{};+(App.Contracts.Form=function(a){var b=function(){+(function(c){c("#contract_form_model").on("change",function(){var d=c(this).val();c(".visible-condition").each(function(){if(c(this).hasClass("visible-condition-"+d)){c(this).show()}else{c(this).hide();c(this).find(".collection:first").data("index",0).empty()}});c(".hiddeable-condition").each(function(){if(c(this).hasClass("hiddeable-condition-"+d)){c(this).hide()}else{c(this).show()}});c(".visible-condition-only").each(function(){if(c(this).hasClass("visible-condition-only-"+d)){c(this).show()}else{c(this).hide()}})});c("#contract_form_signedAt").parent().datetimepicker({format:"DD/MM/YYYY"});c("#contract_form_startAt").parent().datetimepicker({format:"DD/MM/YYYY"});c("#contract_form_endAt").parent().datetimepicker({useCurrent:false,format:"DD/MM/YYYY"});c("#contract_form_startAt").parent().on("dp.change",function(d){c("#contract_form_endAt").parent().data("DateTimePicker").minDate(d.date)});c("#contract_form_endAt").parent().on("dp.change",function(d){c("#contract_form_startAt").parent().data("DateTimePicker").maxDate(d.date)});c(".item-top-service").each(function(){var d=c(this).find(".datetimepicker");c(d[0]).datetimepicker({format:"DD/MM/YYYY HH:mm"});c(d[1]).datetimepicker({format:"DD/MM/YYYY HH:mm",useCurrent:false});c(d[0]).on("dp.change",function(e){c(d[1]).data("DateTimePicker").minDate(e.date)});c(d[1]).on("dp.change",function(e){c(d[0]).data("DateTimePicker").maxDate(e.date)})})}(jQuery));a("#contract").validate({errorPlacement:function(c,d){if(!d.data("tooltipster-ns")){d.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}d.tooltipster("update",a(c).text());d.tooltipster("show")},rules:{"contract_form[startAt]":{required:{depends:function(){return""!==a("#contract_form_endAt").val()}}},"contract_form[endAt]":{required:{depends:function(){return""!==a("#contract_form_startAt").val()}}}},success:function(c,d){a(d).tooltipster("hide")}});+(function(){var d=function(h){h.find(".date:has(.datepicker):first").datetimepicker({format:"DD/MM/YYYY"});h.find(".date:has(.datepicker):last").datetimepicker({format:"DD/MM/YYYY",useCurrent:false});h.find(".date:has(.datepicker):first").on("dp.change",function(i){h.find(".date:has(.datepicker):last").data("DateTimePicker").minDate(i.date)});h.find(".date:has(.datepicker):last").on("dp.change",function(i){h.find(".date:has(.datepicker):first").data("DateTimePicker").maxDate(i.date)})};var c=function(h){h.preventDefault();a(this).closest(".item").remove()};var g=function(h){if(typeof h==="undefined"){h=a("body")}a(h).find(".collection").each(function(){var i=a(this);i.data("index",i.find(">.item").length)})};var f=function(k){var l=a(this).closest(":has(.collection)").find(".collection:first"),j=l.data("prototype"),i=l.data("index");if(l.hasClass("collection-facilities")){var h=a(j.replace(/facilities___name__/g,"facilities_"+i).replace(/facilities\]\[__name__/g,"facilities]["+i))}else{var h=a(j.replace(/__name__/g,i))}l.data("index",i+1);l.append(h);if(h.find(".collection").length>0){g(h)}d(h);a(h.find("input:text:visible, select:visible")[0]).focus()};var e=function(k){var i=a(this).closest(".item"),l=i.closest(".collection"),j=l.data("index");$newItem=i.clone();i.closest(".collection").append($newItem);$newItem.find("[id][name]").each(function(){var n=a(this);if(/facilities_\d+_/.test(n.attr("id"))){var o=n.attr("id"),m=o.replace(/facilities_\d+/,"facilities_"+j);n.attr("id",m);a('label[for="'+o+'"]').attr("for",m);n.attr("name",n.attr("name").replace(/facilities\]\[\d+/,"facilities]["+j))}});var h=$newItem.find(".collection.collection-seasons");h.data("prototype",h.data("prototype").replace(/facilities_\d+/g,"facilities_"+j).replace(/facilities\]\[\d+/g,"facilities]["+j));console.log(h.data("prototype"));l.data("index",j+1);if($newItem.find(".collection").length>0){g($newItem)}$newItem.find(".input-daterange").each(function(){var m=a(this);m.datepicker({inputs:m.find("input:text").toArray()});m.find("input:text:first").on("change",function(){a(this).closest(".item").find("input:text:last").datepicker("setDate",a(this).val())})})};a("body").on("click",".btn-add-item",f);a("body").on("click",".btn-remove",c);a("body").on("click",".btn-clone-item",e);a(".btn-remove").on("click",c);a("body").on("click",".btn-create-rest-seasons",function(){var o=a(this).parent().find("button.btn-add-item"),h=a(this).closest(":has(.collection)").find(".collection:first"),q=[];h.find(".item").each(function(){var i=a(this);q.push({from:moment(i.find("input:text:first").val(),"DD/MM/YYYY",true),to:moment(i.find("input:text:last").val(),"DD/MM/YYYY",true)})});var l=[],k=moment(a("#contract_form_startAt").val(),"DD/MM/YYYY",true),n=moment(a("#contract_form_endAt").val(),"DD/MM/YYYY",true),m=null,r;while(k.isBefore(n,"day")){r=false;a.each(q,function(s){if(k.isSameOrAfter(q[s].from,"day")&&k.isSameOrBefore(q[s].to,"day")){if(null!==m){l.push({from:m.clone(),to:k.clone().subtract(1,"days")});m=null}k=q[s].to.clone();k.add(1,"days");r=true;return false}});if(!r){if(null===m){m=k.clone()}k.add(1,"days")}}if(null!==m){l.push({from:m.clone(),to:k.clone()})}if(l.length>0){for(var j=0;j<l.length;j++){o.trigger("click")}$items=h.find(".item");for(var j=$items.length-l.length;j<$items.length;j++){var p=a($items[j]);p.find("input:text:first").val(l[j-($items.length-l.length)].from.format("DD/MM/YYYY"));p.find("input:text:last").val(l[j-($items.length-l.length)].to.format("DD/MM/YYYY"))}}});g();a(".item-top-service, .item-facility-season, .item-private-house-service, .item-car-rental-service").each(function(){d(a(this))})}())};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Places=typeof App.Places!=="undefined"?App.Places:{};+(App.Places.Form=function(b){var a=function(){b("form#place").validate({errorPlacement:function(c,d){if(!d.data("tooltipster-ns")){d.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}d.tooltipster("update",b(c).text());d.tooltipster("show")},success:function(c,d){b(d).tooltipster("hide")}})};return{init:function(){a()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Prices=typeof App.Prices!=="undefined"?App.Prices:{};+(App.Prices.Form=function(a){var b=function(){a("body").on("change","input.updatable-ajax",function(){var h=a(this);if(h.data("saving")){h.data("saving").xhr.abort()}var g=Date.now(),f=h.data("params"),c=f.split("|"),e={inputId:g,value:h.val()};a.each(c,function(k,j){var l=j.split(":");e[l[0]]=l[1]});h.css({borderColor:"red"}).attr({"ajax-id":g});var d={xhr:a.ajax(Routing.generate("app_contracts_setprice"),{data:e,dataType:"json",method:"POST",success:function(i){a("input:text.updatable-ajax[ajax-id="+i.inputId+"]").val(i.value).css({borderColor:""}).removeAttr("ajax-id").removeData("saving")}})};h.data("saving",d)})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Profile=typeof App.Profile!=="undefined"?App.Profile:{};+(App.Profile.Form=function(a){var b=function(){App.Forms.initTelephoneControl(a("input[type=tel]"));a.validator.addMethod("strongpassword",function(d,c){return this.optional(c)||(/[A-Z]/.test(d)&&/[a-z]/.test(d)&&/[0-9]/.test(d)&&d.length>7)},Translator.trans("Password strong is too low (8 characters minimun and contains at least 1 character from groups [A-Z], [a-z] and [0-9])"));a("form#profile").validate({errorPlacement:function(c,d){if(!d.data("tooltipster-ns")){d.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}d.tooltipster("update",a(c).text());d.tooltipster("show")},success:function(c,d){a(d).tooltipster("hide")}});a(".fileupload").on("change","input:file",function(c,d){if(typeof d!=="undefined"&&d.indexOf("clear")!==-1&&a(this).closest(".fileupload").find('input:checkbox[name="fos_user_profile_form[imageFile][delete]"]').length>0){a(this).closest(".fileupload").find('input:checkbox[name="fos_user_profile_form[imageFile][delete]"]').prop("checked",true)}})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.RentCarTypes=typeof App.RentCarTypes!=="undefined"?App.RentCarTypes:{};+(App.RentCarTypes.Form=function(b){var a=function(){b("#car").validate({errorPlacement:function(c,d){if(!d.data("tooltipster-ns")){d.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}d.tooltipster("update",b(c).text());d.tooltipster("show")},success:function(c,d){b(d).tooltipster("hide")}})};return{init:function(){a()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Suppliers=typeof App.Suppliers!=="undefined"?App.Suppliers:{};+(App.Suppliers.Form=function(d){var b=function(){var e=d("#supplier_form_employees");e.data("index",e.find("> .item").length);d("#btnAddEmployee").on("click",function(i){i.preventDefault();var h=e.data("index"),g=e.data("prototype"),f=d(g.replace(/form_employees___name___/g,"form_employees_"+h+"_").replace(/employees\]\[__name__\]/g,"employees]["+h+"]"));e.append(f);App.Forms.initTelephoneControl(f.find("input[type=tel]"));f.find(".collection-emails").data("index",0);e.data("index",h+1)});d(".collection-emails").each(function(){d(this).data("index",d(this).find(".item").length)});e.on("click",".btn-add-email",function(i){i.preventDefault();var j=d(this).closest(".row").find(".collection-emails"),h=j.data("index"),g=j.data("prototype"),f=d(g.replace(/__name__/g,h));j.append(f);j.data("index",h+1)});e.on("click",".btn-remove-item",function(f){f.preventDefault();console.log(d(this).parents());d(this).closest(".item").fadeOut(function(){d(this).remove()})})};var c=function(){App.Forms.initTelephoneControl(d("form#supplier input[type=tel]"));d('form#supplier select[name$="[place]"]').select2({width:"100%",minimunInputLength:1,ajax:{url:Routing.generate("app_suppliers_getplaces"),dataType:"json",delay:250,method:"GET",processResults:function(e){var f=e.data;f.unshift({id:0,text:""});return{results:f}}}})};var a=function(){d("#supplier").validate({errorPlacement:function(e,f){if(!f.data("tooltipster-ns")){f.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}f.tooltipster("update",d(e).text());f.tooltipster("show")},success:function(e,f){d(f).tooltipster("hide")}})};return{init:function(){c();a();b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Users=typeof App.Users!=="undefined"?App.Users:{};+(App.Users.Form=function(a){var b=function(){App.Forms.initTelephoneControl(a("input[type=tel]"));a.validator.addMethod("strongpassword",function(d,c){return this.optional(c)||(/[A-Z]/.test(d)&&/[a-z]/.test(d)&&/[0-9]/.test(d)&&d.length>7)},Translator.trans("Password strong is too low (8 characters minimun and contains at least 1 character from groups [A-Z], [a-z] and [0-9])"));a("#user").validate({rules:{"{{ form.plainPassword.first.vars.full_name }}":"strongpassword","{{ form.plainPassword.second.vars.full_name }}":{equalTo:"#{{ form.plainPassword.first.vars.id }}"}},errorPlacement:function(c,d){if(!d.data("tooltipster-ns")){d.tooltipster({trigger:"custom",onlyOne:false,position:"bottom-left",positionTracker:true})}d.tooltipster("update",a(c).text());d.tooltipster("show")},success:function(c,d){a(d).tooltipster("hide")}})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Notifications=typeof App.Notifications!=="undefined"?App.Notifications:{};+(App.Notifications.Index=function(a){var b=function(){var c=a("#datatable-x");c.on("click",".btn-change-state",function(d){d.preventDefault();a(this).attr("disabled","disabled");a("#modalConfirm").data("process",a(this));a("#modalConfirm .modal-content").load(a(this).attr("href"),function(){a("#modalConfirm").modal();c.find(".btn[disabled]").removeAttr("disabled");a("#modalConfirm form").ajaxForm({beforeSuccess:function(){a("#modalConfirm button.btn-primary").attr("disabled","disabled")},success:function(e){a("#modalConfirm").modal("hide");a(a("#modalConfirm").data("process")).parent().text(Translator.trans("Updating..."));a("#modalConfirm").removeData("process");c.dataTable().api().draw(true)}})})});c.dataTable({order:[[5,"asc"]],aoColumns:[{name:"name"},{name:"operator"},{name:"client"},{name:"supplier"},{name:"service"},{name:"startAt",searchable:false},{name:"endAt",searchable:false},{name:"reference"},{sortable:false,searchable:false}],processing:true,serverSide:true,ajax:{method:"post",url:Routing.generate("app_notifications_getdata"),data:function(d){return a.extend({},d,{filter:{state:a('form#filter select[name$="[state]"]').val()}})}}});a('form#filter select[name$="[state]"]').on("change",function(){c.dataTable().api().draw(true)})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Places=typeof App.Places!=="undefined"?App.Places:{};+(App.Places.Index=function(a){var b=function(){var c=a("#datatable-x");c.dataTable({columns:[{name:"name",title:Translator.trans("Name")},{name:"postalAddress",title:Translator.trans("Postal address")},{name:"province",title:Translator.trans("Province")},{title:Translator.trans("Actions"),orderable:false,sortable:false,width:"80px"}],serverSide:true,processing:true,ajax:{method:"POST",url:Routing.generate("app_places_getdata")},oSearch:{sSearch:c.data("search")}});c.on("draw.dt",function(){a(this).find("a.btn-delete").on("click",function(e){e.preventDefault();var d=a(this).attr("href"),f=a(this);swal({title:Translator.trans("Confirm remove"),text:Translator.trans("The record will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(g){if(g){f.closest("td").text(Translator.trans("Removing...")).closest("tr").addClass("row-removing");a.ajax(d,{dataType:"json",method:"post",success:function(h){c.find("tr.row-removing").remove();c.dataTable().api().draw(false)}})}})})})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.RentCarTypes=typeof App.RentCarTypes!=="undefined"?App.RentCarTypes:{};+(App.RentCarTypes.Index=function(a){var b=function(){var c=a("#datatable-x");c.dataTable({columnDefs:[{orderable:false,sortable:false,targets:[1]},{name:"name",targets:[0]}],processing:true});c.find("a.btn-delete").on("click",function(e){e.preventDefault();var d=a(this).attr("href"),f=a(this);swal({title:Translator.trans("Confirm remove"),text:Translator.trans("The record will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(g){if(g){f.closest("td").text(Translator.trans("Removing...")).closest("tr").addClass("row-removing");a.ajax(d,{dataType:"json",method:"post",success:function(h){c.find("tr.row-removing").remove();location.href=location.href}})}})})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Suppliers=typeof App.Suppliers!=="undefined"?App.Suppliers:{};+(App.Suppliers.Index=function(a){var b=function(){var c=a("#datatable-suppliers");c.dataTable({columnDefs:[{orderable:false,sortable:false,targets:[2],title:Translator.trans("Actions"),width:"80px"},{name:"name",targets:[0],title:Translator.trans("Name")},{name:"fixedPhone",targets:[1],title:Translator.trans("Fixed phone"),searchable:false,sortable:false}],serverSide:true,processing:true,ajax:{method:"POST",url:Routing.generate("app_suppliers_getdata")}});c.on("draw.dt",function(){a(this).find("a.btn-delete").on("click",function(e){e.preventDefault();var d=a(this).attr("href"),f=a(this);swal({title:Translator.trans("Confirm remove"),text:Translator.trans("The record will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(g){if(g){f.closest("td").text(Translator.trans("Removing...")).closest("tr").addClass("row-removing");a.ajax(d,{dataType:"json",method:"POST",success:function(h){c.find("tr.row-removing").remove();c.dataTable().api().draw(false)}})}})})})};return{init:function(){b()}}}(jQuery));
App=typeof App!=="undefined"?App:{};App.Users=typeof App.Users!=="undefined"?App.Users:{};+(App.Users.Index=function(a){var b=function(){var c=a("#datatable-users");c.dataTable({order:[[1,"asc"]],columnDefs:[{orderable:false,targets:[0,3]}],processing:true});c.on("draw.dt",function(){a(this).find("input").iCheck({checkboxClass:"icheckbox_flat-green"})});a(".btn-delete").on("click",function(e){e.preventDefault();var d=a(this).attr("href");swal({title:Translator.trans("Confirm remove"),text:Translator.trans("The record will be removed. Are you sure you want to continue?"),type:"warning",showCancelButton:true,confirmButtonColor:"#d9534f"},function(f){if(f){location.href=d}})})};return{init:function(){b()}}}(jQuery));