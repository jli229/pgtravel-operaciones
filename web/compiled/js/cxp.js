$(document).ready(function(){var a=$("#datatable-x");a.on("click",".btn-change-state",function(c){c.preventDefault();var b=$(".modal#modal-change");b.find(".modal-content").empty().load($(this).attr("href"),function(){b.find("form").ajaxForm({beforeSubmit:function(){b.find("button[type=submit]").text(Translator.trans("Saving...")).attr("disabled","disabled")},dataType:"json",success:function(e){b.modal("hide");a.dataTable().api().draw(true)}});var d=b.find(".collection");d.data("index",d.find(".item").length);b.find(".btn-add-item").on("click",function(){var f=d.data("index"),e=d.data("prototype");d.append($(e.replace(/__name__/g,f)));d.data("index",f+1)})});b.modal()});a.on("click",".btn-view",function(c){c.preventDefault();var b=$(".modal#modal-view");b.modal();b.find(".modal-content").empty().load($(this).attr("href"))});$(".modal#modal-change button.btn-primary").on("click",function(){$(this).attr("disabled","disabled").text(Translator.trans("Saving..."));$.ajax($(".modal#modal-change").data("record-url"),{data:{notes:$(".modal#modal-change textarea").val()},dataType:"json",method:"POST",success:function(b){a.dataTable().api().draw(false);swal({title:Translator.trans("Success"),text:Translator.trans("Operation done successfuly.")});$(".modal#modal-change").modal("hide")}})});a.dataTable({order:[[3,"asc"]],aoColumns:[{name:"client"},{name:"name"},{name:"service"},{name:"startAt",searchable:false},{name:"endAt",searchable:false},{name:"supplier"},{name:"date",searchable:false},{name:"notes"},{sortable:false,searchable:false}],serverSide:true,processing:true,ajax:{method:"post",url:Routing.generate("app_cxpagar_getdata"),data:function(b){return $.extend({},b,{filter:{state:$('form#filter select[name$="[state]"]').val()}})}}});$("form#filter select").on("change",function(){a.dataTable().api().draw(true)})});